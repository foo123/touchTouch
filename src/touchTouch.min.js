/**
*  touchTouch.js
*  Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.3.0
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";Math;var o=null,t=/^\s+|\s+$/g,n=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(t,"")};function r(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function E(e,t,n,i){null==o&&(o=r()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,o?i:"object"==typeof i?!!i.capture:!!i)}function x(e,t,n,i){null==o&&(o=r()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,o?i:"object"==typeof i?!!i.capture:!!i)}function C(e,t){e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t}function N(e,t){e.classList?e.classList.remove(t):e.className=n((" "+e.className+" ").replace(" "+t+" "," "))}function D(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var k=null,P=null,S=!1,L=0;function T(){if(!S)return!1;S=!1,k=null,N(D(P),"visible"),setTimeout(function(){P.textContent=""},0)}function b(e,t){var n,i,o;e&&"img"===(e.tagName||"").toLowerCase()&&(n=e.width,i=e.height,o=t*(window.innerWidth||document.documentElement.clientWidth),(t=t*(window.innerHeight||document.documentElement.clientHeight))<i*o/n?(e.style.height=String(t)+"px",e.style.width="auto"):(e.style.width=String(o)+"px",e.style.height="auto"))}function A(o,e){var i=this;if(!(i instanceof A))return new A(o,e);var r,s,u,a,t,n,c,l,p,h,v,d=0,f=0,m=null,w=(t=!!(e=e||{}).auto,f=e.fit,P||((P=document.createElement("div")).id="galleryOverlay","ontouchstart"in window&&C(P,"is-touch-screen"),document.body.appendChild(D(P)),E(window,"keydown",function(e){k&&(27===e.keyCode?T():37===e.keyCode?k.showPrevious():39===e.keyCode&&k.showNext())},{passive:!0,capture:!1})),r=document.createElement("div"),s=document.createElement("a"),u=document.createElement("a"),r.id="gallerySlider"+String(++L),C(r,"gallery-slider"),e.slider&&C(r,e.slider),C(s,"prev-arrow"),e.prevArrow&&C(s,e.prevArrow),C(u,"next-arrow"),e.nextArrow&&C(u,e.nextArrow),o=Array.prototype.slice.call(o||[]),a=o.map(function(e,t){var n=document.createElement("div");return C(n,"placeholder"),r.appendChild(n),n}),E(s,"click",c=function(e){e.preventDefault&&e.preventDefault(),i.showPrevious()},{passive:!1,capture:!1}),E(u,"click",l=function(e){e.preventDefault&&e.preventDefault(),i.showNext()},{passive:!1,capture:!1}),E(r,"touchstart",p=function(e){var t,n;return"img"!==e.target.tagName.toLowerCase()&&s!==e.target&&u!==e.target?setTimeout(T,100):(t=e.touches&&e.touches.length)&&1!==e.touches.length||(e.preventDefault&&e.preventDefault(),n=(t?e.touches[0]:e).pageX,E(r,t?"touchmove":"mousemove",m=function(e){e.preventDefault&&e.preventDefault();e=(t?e.touches[0]:e).pageX-n;20<e?(m&&x(r,m.event,m,{passive:!1,capture:!1}),m=null,i.showPrevious()):e<-20&&(m&&x(r,m.event,m,{passive:!1,capture:!1}),m=null,i.showNext())},{passive:!1,capture:!1}),m.event=t?"touchmove":"mousemove"),!1},{passive:!1,capture:!1}),E(r,"touchend",h=function(){m&&x(r,m.event,m,{passive:!1,capture:!1}),m=null},{passive:!0,capture:!1}),E(r,"touchcancel",h,{passive:!0,capture:!1}),E(r,"mousedown",p,{passive:!1,capture:!1}),E(r,"mouseup",h,{passive:!0,capture:!1}),t||(n=o.map(function(e,t){return E(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),d=t,i.showGallery()},{passive:!1,capture:!1}),e})),i.showGallery=function(){var e;k!==i&&(P.textContent="",P.appendChild(r),P.appendChild(s),P.appendChild(u),w(d=t?0:d),e=i,S||(S=!0,k=e,"none"===(e=P).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),setTimeout(function(){C(P,"visible")},100)),g(d),y(d+1),y(d-1))},function(e){r.style.left=String(100*-e)+"%"}),y=function(e){if(e<0||e>=o.length)return!1;setTimeout(function(){g(e)},1e3)},g=function(e){if(e<0||e>=o.length)return!1;var t,n,i;a[e].children.length||(t=o[e].href,n=function(){f&&(b(this,f),v||E(window,"resize",v=function(){a.forEach(function(e){b(e.children[0],f)})},{passive:!0,capture:!1})),a[e].textContent="",a[e].appendChild(this)},E(i=document.createElement("img"),"load",function e(){x(i,"load",e),C(i,i.height>i.width?"is-portrait":i.height===i.width?"is-square":"is-landscape"),n.call(i)}),i.src=t)};i.showNext=function(){k===i&&(d+1<o.length?(w(++d),y(d+1)):(C(r,"rightSpring"),setTimeout(function(){N(r,"rightSpring")},500)))},i.showPrevious=function(){k===i&&(0<d?(w(--d),y(d-1)):(C(r,"leftSpring"),setTimeout(function(){N(r,"leftSpring")},500)))},i.dispose=function(){r&&(k===i&&T(),v&&x(window,"resize",v,{passive:!0,capture:!1}),m&&x(r,m.event,m,{passive:!1,capture:!1}),x(r,"touchstart",p,{passive:!1,capture:!1}),x(r,"touchend",h,{passive:!0,capture:!1}),x(r,"touchcancel",h,{passive:!0,capture:!1}),x(r,"mousedown",p,{passive:!1,capture:!1}),x(r,"mouseup",h,{passive:!0,capture:!1}),x(s,"click",c,{passive:!1,capture:!1}),x(u,"click",l,{passive:!1,capture:!1}),t||o.forEach(function(e,t){x(e,"click",n[t],{passive:!1,capture:!1})}),r.textContent="",e=l=c=h=p=m=v=n=o=a=u=s=r=null,i.showGallery=null,i.showNext=null,i.showPrevious=null)}}A.VERSION="1.3.0",A.prototype={constructor:A,dispose:null,showGallery:null,showNext:null,showPrevious:null},window.touchTouch=A}();