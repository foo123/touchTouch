/**
*  touchTouch.js
*  Enhanced Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.5.0
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var L=Math,i=null,t=/(?:-?\d+(?:\.\d+)?)|(?:-?\.\d+)/g,n=/^\s+|\s+$/g,r=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(n,"")};function X(){}function o(e){return parseFloat(e||0)||0}function G(e){return(String(e).match(t)||[]).map(o)}function V(e,t,n){return L.min(L.max(e,t),n)}function Y(n,r,i){var o;return function(){var e=this,t=arguments;if(clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},r),i)return i.apply(e,t)}}function a(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",X,e),window.removeEventListener("test",X,e)}catch(e){t=!1}return t}function _(e,t,n,r){null==i&&(i=a()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function A(e,t,n,r){null==i&&(i=a()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function j(e,t){return e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t,e}function z(e,t){e.classList?e.classList.remove(t):e.className=r((" "+e.className+" ").replace(" "+t+" "," "))}function O(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var H=null,W=null,q=!1,F=0;function I(){q&&(q=!1,H=null,z(O(W),"tt-visible"),setTimeout(function(){W.textContent=""},0))}function M(e,t){e.style.left=String(100*-t)+"%"}function R(e,t){var n,r,i;e&&"img"===(e.tagName||"").toLowerCase()&&(n=e.width,r=e.height,i=t*(window.innerWidth||document.documentElement.clientWidth),(t=t*(window.innerHeight||document.documentElement.clientHeight))<r*i/n?(e.style.height=String(t)+"px",e.style.width="auto"):(e.style.width=String(i)+"px",e.style.height="auto"))}function $(e){e&&(e.style.removeProperty("margin-left"),e.style.removeProperty("margin-top"),e.style.removeProperty("transform-origin"),e.style.removeProperty("transform"))}function B(e,t,n){e&&(e.style.marginLeft=String(t)+"px",e.style.marginTop=String(n)+"px")}function J(e,t){e&&(e.style.transformOrigin="center center",e.style.transform="scale("+String(t)+","+String(t)+")")}function Q(i,e){var c=this;if(!(c instanceof Q))return new Q(i,e);var l,p,h,t,o,n,d,f,r,a,u,s,v,y,g,m,w,D,C,P=0,x=4,k=.08,E=15,S=15,T=0,N=0,b=0,K=1;i=Array.prototype.slice.call(i||[]),g=function(e){if(e<0||e>=i.length)return!1;var t,n,r;o[e].children.length||(t=i[e].href,n=function(){P&&(R(this,P),y||_(window,"resize",y=Y(function(){o.forEach(function(e){R(e.children[0],P)})},100),{passive:!0,capture:!1})),o[e].textContent="",j(o[e],"tt-img"),o[e].appendChild(this)},_(r=document.createElement("img"),"load",function e(){A(r,"load",e),j(r,r.height>r.width?"tt-portrait":r.height===r.width?"tt-square":"tt-landscape"),n.call(r)}),r.src=t)},m=function(e){if(e<0||e>=i.length)return!1;setTimeout(function(){g(e)},200)},w=function(){d&&A(l,d.isTouch?"touchmove":"mousemove",d,{passive:!1,capture:!1}),f&&(f.isTouch?(A(l,"touchend",f,{passive:!0,capture:!1}),A(l,"touchcancel",f,{passive:!0,capture:!1})):A(l,"mouseup",f,{passive:!0,capture:!1})),f=d=null},D=function(e){var t;K=e?(t=[G((t=e).style.getPropertyValue("margin-left")||"")[0]||0,G(t.style.getPropertyValue("margin-top")||"")[0]||0],e=G(e.style.getPropertyValue("transform")||""),N=t[0],b=t[1],null!=e[0]?e[0]:1):(b=N=0,1)},C=!!(e=e||{}).auto,P=e.fit,null!=e._factor&&(x=+e._factor),null!=e._threshold&&(k=+e._threshold),null!=e._move&&(E=S=+e._move),W||(j(W=document.createElement("div"),"tt-gallery-overlay"),"ontouchstart"in window&&j(W,"tt-touch-screen"),O(W)),l=j(document.createElement("div"),"tt-gallery-slider"),e.slider&&j(l,e.slider),l.id="tt-gallery-slider-"+String(++F),l.style.setProperty("touch-action","none"),l.style.setProperty("-moz-transition-duration",String(e.swipe||400)+"ms"),l.style.setProperty("-webkit-transition-duration",String(e.swipe||400)+"ms"),l.style.setProperty("transition-duration",String(e.swipe||400)+"ms"),p=j(document.createElement("a"),"tt-prev-arrow"),e.prevArrow&&j(p,e.prevArrow),h=j(document.createElement("a"),"tt-next-arrow"),e.nextArrow&&j(h,e.nextArrow),e.showCaption&&(t=j(document.createElement("div"),"tt-caption"),e.caption)&&j(t,e.caption),o=i.map(function(e){var t=document.createElement("div");return j(t,"tt-placeholder"),l.appendChild(t),t}),_(l,"touchstart",n=Y(function(e){var o,a,u,n,r,s=e.touches&&e.touches.length,t=e.target;"img"===t.tagName.toLowerCase()?s&&2===e.touches.length||!s&&(e.ctrlKey||e.metaKey)?(w(),o=s?e.touches[0].pageX<=e.touches[1].pageX?[e.touches[0],e.touches[1]]:[e.touches[1],e.touches[0]]:null,a=s?[o[0].pageX,o[0].pageY,o[1].pageX,o[1].pageY]:[e.pageX,e.pageY],u=t,_(l,s?"touchmove":"mousemove",d=function(e){var t,n,r,i;return e.preventDefault&&e.preventDefault(),s&&2!==e.touches.length||(t=s?[o[0].identifier===e.touches[0].identifier?e.touches[0]:o[0].identifier===e.touches[1].identifier?e.touches[1]:null,o[1].identifier===e.touches[0].identifier?e.touches[0]:o[1].identifier===e.touches[1].identifier?e.touches[1]:null]:null,(!s||t[0]&&t[1])&&(t=s?[t[0].pageX,t[0].pageY,t[1].pageX,t[1].pageY]:[e.pageX,e.pageY],e=s?(n=N+t[2]-a[2],r=b+t[3]-a[3],i=L.hypot(t[2]-t[0],t[3]-t[1])/L.hypot(a[2]-a[0],a[3]-a[1])-1,V(K+i*x,1,3)):(n=N+t[0]-a[0],r=b+t[1]-a[1],K),L.abs(e-1)<.01?$(u,N=0,b=0,K=1):!s||L.abs(i)<k?B(u,N=n,b=r):J(u,K=e),a=t)),!1},{passive:!1,capture:!1}),d.isTouch=s,f=Y(w,200),s?(_(l,"touchend",f,{passive:!0,capture:!1}),_(l,"touchcancel",f,{passive:!0,capture:!1})):_(l,"mouseup",f,{passive:!0,capture:!1}),f.isTouch=s):s&&1!==e.touches.length||(w(),n=s?e.touches[0]:null,r=(s?n:e).pageX,_(l,s?"touchmove":"mousemove",d=function(e){var t;return e.preventDefault&&e.preventDefault(),s&&(1!==e.touches.length||n.identifier!==e.touches[0].identifier)||(e=(s?e.touches[0]:e).pageX-r,(t=s?E:S)<e?c.showPrevious():e<-t&&c.showNext()),!1},{passive:!1,capture:!1}),d.isTouch=s,f=Y(w,200),s?(_(l,"touchend",f,{passive:!0,capture:!1}),_(l,"touchcancel",f,{passive:!0,capture:!1})):_(l,"mouseup",f,{passive:!0,capture:!1}),f.isTouch=s):p!==t&&h!==t&&c.hideGallery()},60,function(e){return e.preventDefault&&e.preventDefault(),!1}),{passive:!1,capture:!1}),_(l,"mousedown",n,{passive:!1,capture:!1}),_(l,"wheel",r=function(e){var t;"img"===e.target.tagName.toLowerCase()&&(e.ctrlKey||e.metaKey)&&(e.preventDefault&&e.preventDefault(),t=e.target,K=V(K-.001*e.deltaY,1,3),L.abs(K-1)<.01?$(t,N=0,b=0,K=1):J(t,K))},{passive:!1,capture:!1}),_(p,"click",u=function(e){e.preventDefault&&e.preventDefault(),c.showPrevious()},{passive:!(a=function(e){var t;H===c&&(t=0<=T&&T<i.length?o[T].children[0]:null,27===e.keyCode?c.hideGallery():38===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<K&&(e.preventDefault&&e.preventDefault(),B(t,N,b-=10)):40===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<K&&(e.preventDefault&&e.preventDefault(),B(t,N,b+=10)):37===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<K&&(e.preventDefault&&e.preventDefault(),B(t,N-=10,b)):39===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<K&&(e.preventDefault&&e.preventDefault(),B(t,N+=10,b)):38===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),K=V(K+.2,1,3),L.abs(K-1)<.01?$(t,N=0,b=0,K=1):J(t,K)):40===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),K=V(K-.2,1,3),L.abs(K-1)<.01?$(t,N=0,b=0,K=1):J(t,K)):37===e.keyCode?(e.preventDefault&&e.preventDefault(),c.showPrevious()):39===e.keyCode&&(e.preventDefault&&e.preventDefault(),c.showNext()))}),capture:!1}),_(h,"click",s=function(e){e.preventDefault&&e.preventDefault(),c.showNext()},{passive:!1,capture:!1}),C||(v=i.map(function(e,t){return _(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),T=t,c.showGallery()},{passive:!1,capture:!1}),e})),c.showGallery=function(){var e;return H!==c&&(W.textContent="",W.appendChild(l),W.appendChild(p),W.appendChild(h),t&&W.appendChild(t),i.length&&D(o[T].children[0]),M(l,T),t&&i.length&&(t.textContent=String(T+1)+"/"+String(i.length)),e=c,q||(q=!0,H=e,document.body.appendChild(("none"===(e=W).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),e)),setTimeout(function(){j(W,"tt-visible")},60)),_(window,"keydown",a,{passive:!1,capture:!1}),g(T),m(T+1),m(T-1)),c},c.hideGallery=function(){return H===c&&(w(),A(window,"keydown",a,{passive:!1,capture:!1}),I()),c},c.showNext=function(){var e;return H===c&&(w(),T+1<i.length?(e=o[T].children[0],setTimeout(function(){$(e)},40),D(o[++T].children[0]),M(l,T),t&&i.length&&(t.textContent=String(T+1)+"/"+String(i.length)),m(T+1)):(j(l,"tt-right-spring"),setTimeout(function(){z(l,"tt-right-spring")},500))),c},c.showPrevious=function(){var e;return H===c&&(w(),0<T?(e=o[T].children[0],setTimeout(function(){$(e)},40),D(o[--T].children[0]),M(l,T),t&&i.length&&(t.textContent=String(T+1)+"/"+String(i.length)),m(T-1)):(j(l,"tt-left-spring"),setTimeout(function(){z(l,"tt-left-spring")},500))),c},c.dispose=function(){l&&(w(),y&&A(window,"resize",y,{passive:!0,capture:!1}),A(window,"keydown",a,{passive:!1,capture:!1}),A(l,"touchstart",n,{passive:!1,capture:!1}),A(l,"mousedown",n,{passive:!1,capture:!1}),A(l,"wheel",r,{passive:!1,capture:!1}),A(p,"click",u,{passive:!1,capture:!1}),A(h,"click",s,{passive:!1,capture:!1}),v&&i.forEach(function(e,t){A(e,"click",v[t],{passive:!1,capture:!1})}),H===c&&I(),v=s=u=r=f=d=n=a=y=null,l.textContent="",e=i=o=t=h=p=l=null,T=-1,c.showGallery=X,c.hideGallery=X,c.showNext=X,c.showPrevious=X)}}Q.VERSION="1.5.0",Q.prototype={constructor:Q,dispose:X,showGallery:X,hideGallery:X,showNext:X,showPrevious:X},window.touchTouch=Q}();