/**
*  touchTouch.js
*  Enhanced Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.5.2
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var G=Math,i=null,t=/(?:-?\d+(?:\.\d+)?)|(?:-?\.\d+)/g,n=/^\s+|\s+$/g,r=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(n,"")};function V(){}function o(e){return parseFloat(e||0)||0}function Y(e){return(String(e).match(t)||[]).map(o)}function _(e,t,n){return G.min(G.max(e,t),n)}function z(n,r,i){var o;return function(){var e=this,t=arguments;if(clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},r),i)return i.apply(e,t)}}function a(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",V,e),window.removeEventListener("test",V,e)}catch(e){t=!1}return t}function j(e,t,n,r){null==i&&(i=a()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function O(e,t,n,r){null==i&&(i=a()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function H(e,t){return e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t,e}function W(e,t){e.classList?e.classList.remove(t):e.className=r((" "+e.className+" ").replace(" "+t+" "," "))}function q(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var F=null,I=null,M=!1,R=0;function $(){M&&(M=!1,F=null,W(q(I),"tt-visible"),setTimeout(function(){I.textContent=""},0))}function B(e,t){e.style.left=String(100*-t)+"%"}function J(e,t,n){var r,i,o;e&&"img"===(e.tagName||"").toLowerCase()&&(o=e.width,r=e.height,i=window.innerWidth||document.documentElement.clientWidth,o*(o=window.innerHeight||document.documentElement.clientHeight)<r*i?(e.style.height=String(t*G.min(n,o))+"px",e.style.width="auto"):(e.style.width=String(t*G.min(n,i))+"px",e.style.height="auto"))}function Q(e){e&&(e.style.removeProperty("margin-left"),e.style.removeProperty("margin-top"),e.style.removeProperty("transform-origin"),e.style.removeProperty("transform"))}function U(e,t,n){e&&(e.style.marginLeft=String(t)+"px",e.style.marginTop=String(n)+"px")}function Z(e,t){e&&(e.style.transformOrigin="center center",e.style.transform="scale("+String(t)+","+String(t)+")")}function ee(i,e){var c=this;if(!(c instanceof ee))return new ee(i,e);var l,p,h,r,o,t,d,f,n,a,u,s,v,y,m,g,w,D,C,P,k=!1,E=0,T=1/0,x=4,b=.08,S=15,N=15,K=0,L=0,A=0,X=1;i=Array.prototype.slice.call(i||[]),m=function(e){if(e<0||e>=i.length)return!1;var t,n,r;o[e].children.length||(t=i[e].href,n=function(){E&&(J(this,E,T),y||j(window,"resize",y=z(function(){o.forEach(function(e){J(e.children[0],E,T)})},100),{passive:!0,capture:!1})),o[e].textContent="",H(o[e],"tt-img"),o[e].appendChild(this)},j(r=document.createElement("img"),"load",function e(){O(r,"load",e),H(r,r.height>r.width?"tt-portrait":r.height===r.width?"tt-square":"tt-landscape"),n.call(r)}),r.src=t)},D=function(e){var t,n;r&&i&&i.length&&(t=i[e],n=String(e+1)+"/"+String(i.length),k&&(n=(t.hasAttribute?t.hasAttribute("data-caption")?t.getAttribute("data-caption"):t.hasAttribute("title")?t.getAttribute("title"):n:i[e].caption)||n),r.textContent=n)},g=function(e){if(e<0||e>=i.length)return!1;setTimeout(function(){m(e)},200)},w=function(){d&&O(l,d.isTouch?"touchmove":"mousemove",d,{passive:!1,capture:!1}),f&&(f.isTouch?(O(l,"touchend",f,{passive:!0,capture:!1}),O(l,"touchcancel",f,{passive:!0,capture:!1})):O(l,"mouseup",f,{passive:!0,capture:!1})),f=d=null},C=function(e){var t;X=e?(t=[Y((t=e).style.getPropertyValue("margin-left")||"")[0]||0,Y(t.style.getPropertyValue("margin-top")||"")[0]||0],e=Y(e.style.getPropertyValue("transform")||""),L=t[0],A=t[1],null!=e[0]?e[0]:1):(A=L=0,1)},P=!!(e=e||{}).auto,E=e.fit,T=null!=e.fitsize?+e.fitsize:1/0,null!=e._factor&&(x=+e._factor),null!=e._threshold&&(b=+e._threshold),null!=e._move&&(S=N=+e._move),I||(H(I=document.createElement("div"),"tt-gallery-overlay"),"ontouchstart"in window&&H(I,"tt-touch-screen"),q(I)),l=H(document.createElement("div"),"tt-gallery-slider"),e.slider&&H(l,e.slider),l.id="tt-gallery-slider-"+String(++R),l.style.setProperty("touch-action","none"),l.style.setProperty("-moz-transition-duration",String(e.swipe||400)+"ms"),l.style.setProperty("-webkit-transition-duration",String(e.swipe||400)+"ms"),l.style.setProperty("transition-duration",String(e.swipe||400)+"ms"),p=H(document.createElement("a"),"tt-prev-arrow"),e.prevArrow&&H(p,e.prevArrow),h=H(document.createElement("a"),"tt-next-arrow"),e.nextArrow&&H(h,e.nextArrow),e.showCaption&&(r=H(document.createElement("div"),"tt-caption"),e.caption&&H(r,e.caption),k=!!e.customCaption),o=i.map(function(e){var t=document.createElement("div");return H(t,"tt-placeholder"),l.appendChild(t),t}),j(l,"touchstart",t=z(function(e){var o,a,u,n,r,s=e.touches&&e.touches.length,t=e.target;"img"===t.tagName.toLowerCase()?s&&2===e.touches.length||!s&&(e.ctrlKey||e.metaKey)?(w(),o=s?e.touches[0].pageX<=e.touches[1].pageX?[e.touches[0],e.touches[1]]:[e.touches[1],e.touches[0]]:null,a=s?[o[0].pageX,o[0].pageY,o[1].pageX,o[1].pageY]:[e.pageX,e.pageY],u=t,j(l,s?"touchmove":"mousemove",d=function(e){var t,n,r,i;return e.preventDefault&&e.preventDefault(),s&&2!==e.touches.length||(t=s?[o[0].identifier===e.touches[0].identifier?e.touches[0]:o[0].identifier===e.touches[1].identifier?e.touches[1]:null,o[1].identifier===e.touches[0].identifier?e.touches[0]:o[1].identifier===e.touches[1].identifier?e.touches[1]:null]:null,(!s||t[0]&&t[1])&&(t=s?[t[0].pageX,t[0].pageY,t[1].pageX,t[1].pageY]:[e.pageX,e.pageY],e=s?(n=L+t[2]-a[2],r=A+t[3]-a[3],i=G.hypot(t[2]-t[0],t[3]-t[1])/G.hypot(a[2]-a[0],a[3]-a[1])-1,_(X+i*x,1,3)):(n=L+t[0]-a[0],r=A+t[1]-a[1],X),G.abs(e-1)<.01?Q(u,L=0,A=0,X=1):!s||G.abs(i)<b?U(u,L=n,A=r):Z(u,X=e),a=t)),!1},{passive:!1,capture:!1}),d.isTouch=s,f=z(w,200),s?(j(l,"touchend",f,{passive:!0,capture:!1}),j(l,"touchcancel",f,{passive:!0,capture:!1})):j(l,"mouseup",f,{passive:!0,capture:!1}),f.isTouch=s):s&&1!==e.touches.length||(w(),n=s?e.touches[0]:null,r=(s?n:e).pageX,j(l,s?"touchmove":"mousemove",d=function(e){var t;return e.preventDefault&&e.preventDefault(),s&&(1!==e.touches.length||n.identifier!==e.touches[0].identifier)||(e=(s?e.touches[0]:e).pageX-r,(t=s?S:N)<e?c.showPrevious():e<-t&&c.showNext()),!1},{passive:!1,capture:!1}),d.isTouch=s,f=z(w,200),s?(j(l,"touchend",f,{passive:!0,capture:!1}),j(l,"touchcancel",f,{passive:!0,capture:!1})):j(l,"mouseup",f,{passive:!0,capture:!1}),f.isTouch=s):p!==t&&h!==t&&c.hideGallery()},60,function(e){return e.preventDefault&&e.preventDefault(),!1}),{passive:!1,capture:!1}),j(l,"mousedown",t,{passive:!1,capture:!1}),j(l,"wheel",n=function(e){var t;"img"===e.target.tagName.toLowerCase()&&(e.ctrlKey||e.metaKey)&&(e.preventDefault&&e.preventDefault(),t=e.target,X=_(X-.001*e.deltaY,1,3),G.abs(X-1)<.01?Q(t,L=0,A=0,X=1):Z(t,X))},{passive:!1,capture:!1}),j(p,"click",u=function(e){e.preventDefault&&e.preventDefault(),c.showPrevious()},{passive:!(a=function(e){var t;F===c&&(t=0<=K&&K<i.length?o[K].children[0]:null,27===e.keyCode?c.hideGallery():38===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<X&&(e.preventDefault&&e.preventDefault(),U(t,L,A-=10)):40===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<X&&(e.preventDefault&&e.preventDefault(),U(t,L,A+=10)):37===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<X&&(e.preventDefault&&e.preventDefault(),U(t,L-=10,A)):39===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<X&&(e.preventDefault&&e.preventDefault(),U(t,L+=10,A)):38===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),X=_(X+.2,1,3),G.abs(X-1)<.01?Q(t,L=0,A=0,X=1):Z(t,X)):40===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),X=_(X-.2,1,3),G.abs(X-1)<.01?Q(t,L=0,A=0,X=1):Z(t,X)):37===e.keyCode?(e.preventDefault&&e.preventDefault(),c.showPrevious()):39===e.keyCode&&(e.preventDefault&&e.preventDefault(),c.showNext()))}),capture:!1}),j(h,"click",s=function(e){e.preventDefault&&e.preventDefault(),c.showNext()},{passive:!1,capture:!1}),P||(v=i.map(function(e,t){return j(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),K=t,c.showGallery()},{passive:!1,capture:!1}),e})),c.showGallery=function(){var e;return F!==c&&(I.textContent="",I.appendChild(l),I.appendChild(p),I.appendChild(h),r&&I.appendChild(r),i.length&&C(o[K].children[0]),B(l,K),D(K),e=c,M||(M=!0,F=e,document.body.appendChild(("none"===(e=I).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),e)),setTimeout(function(){H(I,"tt-visible")},60)),j(window,"keydown",a,{passive:!1,capture:!1}),m(K),g(K+1),g(K-1)),c},c.hideGallery=function(){return F===c&&(w(),O(window,"keydown",a,{passive:!1,capture:!1}),$()),c},c.showNext=function(){var e;return F===c&&(w(),K+1<i.length?(e=o[K].children[0],setTimeout(function(){Q(e)},40),C(o[++K].children[0]),B(l,K),D(K),g(K+1)):(H(l,"tt-right-spring"),setTimeout(function(){W(l,"tt-right-spring")},500))),c},c.showPrevious=function(){var e;return F===c&&(w(),0<K?(e=o[K].children[0],setTimeout(function(){Q(e)},40),C(o[--K].children[0]),B(l,K),D(K),g(K-1)):(H(l,"tt-left-spring"),setTimeout(function(){W(l,"tt-left-spring")},500))),c},c.dispose=function(){l&&(w(),y&&O(window,"resize",y,{passive:!0,capture:!1}),O(window,"keydown",a,{passive:!1,capture:!1}),O(l,"touchstart",t,{passive:!1,capture:!1}),O(l,"mousedown",t,{passive:!1,capture:!1}),O(l,"wheel",n,{passive:!1,capture:!1}),O(p,"click",u,{passive:!1,capture:!1}),O(h,"click",s,{passive:!1,capture:!1}),v&&i.forEach(function(e,t){O(e,"click",v[t],{passive:!1,capture:!1})}),F===c&&$(),v=s=u=n=f=d=t=a=y=null,l.textContent="",e=i=o=r=h=p=l=null,K=-1,c.showGallery=V,c.hideGallery=V,c.showNext=V,c.showPrevious=V)}}ee.VERSION="1.5.2",ee.prototype={constructor:ee,dispose:V,showGallery:V,hideGallery:V,showNext:V,showPrevious:V},window.touchTouch=ee}();