/**
*  touchTouch.js
*  Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.2.0
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var o=null,t=/^\s+|\s+$/g,n=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(t,"")};function i(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function w(e,t,n,r){return null==o&&(o=i()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,o?r:"object"==typeof r?!!r.capture:!!r),e}function g(e,t,n,r){return null==o&&(o=i()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,o?r:"object"==typeof r?!!r.capture:!!r),e}function E(e,t){return e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t,e}function C(e,t){return e.classList?e.classList.remove(t):e.className=n((" "+e.className+" ").replace(" "+t+" "," ")),e}function N(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var k=null,x=null,D=!1,P=0;function T(){D&&(D=!1,k=null,C(N(x),"visible"),setTimeout(function(){x.textContent=""},0))}function L(o,e){var i=this;if(!(i instanceof L))return new L(o,e);var a,t,n,c,r,s,u,l,p,h,v,d=0;e=e||{},x||((x=document.createElement("div")).id="galleryOverlay","ontouchstart"in window&&E(x,"is-touch-screen"),document.body.appendChild(N(x)),w(window,"keydown",function(e){k&&(27===e.keyCode?T():37===e.keyCode?k.showPrevious():39===e.keyCode&&k.showNext())},{passive:!0,capture:!1})),a=document.createElement("div"),t=document.createElement("a"),n=document.createElement("a"),a.id="gallerySlider"+String(++P),E(a,"gallery-slider"),e.slider&&E(a,e.slider),E(t,"prev-arrow"),e.prevArrow&&E(t,e.prevArrow),E(n,"next-arrow"),e.nextArrow&&E(n,e.nextArrow),o=Array.prototype.slice.call(o||[]),c=o.map(function(e,t){var n=document.createElement("div");return E(n,"placeholder"),a.appendChild(n),n}),w(a,"click",s=function(e){"img"!==e.target.tagName.toLowerCase()&&T()},{passive:!0,capture:!1}),w(t,"click",u=function(e){e.preventDefault&&e.preventDefault(),i.showPrevious()},{passive:!1,capture:!1}),w(n,"click",l=function(e){e.preventDefault&&e.preventDefault(),i.showNext()},{passive:!1,capture:!1}),w(a,"touchstart",p=function(e){if("img"!==e.target.tagName.toLowerCase()||!function(e,t){if(e.closest)return e.closest("#"+t);for(;e;){if(t===e.id)return e;e=e.parentNode}}(e.target,a.id))return!1;var n=e,r=n.changedTouches[0].pageX;return w(a,"touchmove",h=function e(t){t.preventDefault&&t.preventDefault(),10<(n=t.touches[0]||t.changedTouches[0]).pageX-r?(g(a,"touchmove",e,{passive:!1,capture:!1}),i.showPrevious()):n.pageX-r<-10&&(g(a,"touchmove",e,{passive:!1,capture:!1}),i.showNext())},{passive:!1,capture:!1}),!1},{passive:!0,capture:!1}),w(a,"touchend",v=function(){h&&g(a,"touchmove",h,{passive:!1,capture:!1})},{passive:!0,capture:!1}),r=o.map(function(e,t){return w(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),d=t,i.showGallery()},{passive:!1,capture:!1}),e}),i.showGallery=function(){var e;k!==i&&(x.textContent="",x.appendChild(a),x.appendChild(t),x.appendChild(n),f(d),e=i,D||(D=!0,k=e,"none"===(e=x).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),setTimeout(function(){E(x,"visible")},100)),y(d),m(d+1),m(d-1))};var f=function(e){a.style.left=String(100*-e)+"%"},m=function(e){if(e<0||e>=o.length)return!1;setTimeout(function(){y(e)},1e3)},y=function(e){if(e<0||e>=o.length)return!1;var t,n,r;c[e].children.length||(t=o[e].href,n=function(){c[e].textContent="",c[e].appendChild(this)},w(r=document.createElement("img"),"load",function e(){g(r,"load",e),E(r,r.height>r.width?"is-portrait":r.height===r.width?"is-square":"is-landscape"),n.call(r)}),r.src=t)};i.showNext=function(){k===i&&(d+1<o.length?(f(++d),m(d+1)):(E(a,"rightSpring"),setTimeout(function(){C(a,"rightSpring")},500)))},i.showPrevious=function(){k===i&&(0<d?(f(--d),m(d-1)):(E(a,"leftSpring"),setTimeout(function(){C(a,"leftSpring")},500)))},i.dispose=function(){a&&(k===i&&T(),h&&g(a,"touchmove",h,{passive:!1,capture:!1}),g(a,"touchstart",p,{passive:!0,capture:!1}),g(a,"touchend",v,{passive:!0,capture:!1}),g(a,"click",s,{passive:!0,capture:!1}),g(t,"click",u,{passive:!1,capture:!1}),g(n,"click",l,{passive:!1,capture:!1}),o.forEach(function(e,t){g(e,"click",r[t],{passive:!1,capture:!1})}),a.textContent="",e=l=u=s=v=p=h=r=o=c=n=t=a=null,i.showGallery=null,i.showNext=null,i.showPrevious=null)}}L.VERSION="1.2.0",L.prototype={constructor:L,dispose:null,showGallery:null,showNext:null,showPrevious:null},window.touchTouch=L}();