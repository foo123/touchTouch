/**
*  touchTouch.js
*  Enhanced Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.5.0
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var k=Math,i=null,t=/(?:-?\d+(?:\.\d+)?)|(?:-?\.\d+)/g,n=/^\s+|\s+$/g,r=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(n,"")};function N(){}function o(e){return parseFloat(e||0)||0}function b(e){return(String(e).match(t)||[]).map(o)}function K(e,t,n){return k.min(k.max(e,t),n)}function L(n,r,i){var o;return function(){var e=this,t=arguments;if(clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},r),i)return i.apply(e,t)}}function a(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",N,e),window.removeEventListener("test",N,e)}catch(e){t=!1}return t}function X(e,t,n,r){null==i&&(i=a()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function G(e,t,n,r){null==i&&(i=a()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function V(e,t){return e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t,e}function Y(e,t){e.classList?e.classList.remove(t):e.className=r((" "+e.className+" ").replace(" "+t+" "," "))}function A(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var j=null,z=null,O=!1,H=0;function W(){O&&(O=!1,j=null,Y(A(z),"tt-visible"),setTimeout(function(){z.textContent=""},0))}function q(e,t){e.style.left=String(100*-t)+"%"}function F(e,t){var n,r,i;e&&"img"===(e.tagName||"").toLowerCase()&&(n=e.width,r=e.height,i=t*(window.innerWidth||document.documentElement.clientWidth),(t=t*(window.innerHeight||document.documentElement.clientHeight))<r*i/n?(e.style.height=String(t)+"px",e.style.width="auto"):(e.style.width=String(i)+"px",e.style.height="auto"))}function I(e){e&&(e.style.removeProperty("margin-left"),e.style.removeProperty("margin-top"),e.style.removeProperty("transform-origin"),e.style.removeProperty("transform"))}function M(e,t,n){e&&(e.style.marginLeft=String(t)+"px",e.style.marginTop=String(n)+"px")}function R(e,t){e&&(e.style.transformOrigin="center center",e.style.transform="scale("+String(t)+","+String(t)+")")}function $(i,e){var c=this;if(!(c instanceof $))return new $(i,e);var l,p,h,t,o,n,f,d,r,a,u,s,v,y,g,m,w,D,C,P=0,x=0,E=0,S=0,T=1;i=Array.prototype.slice.call(i||[]),g=function(e){if(e<0||e>=i.length)return!1;var t,n,r;o[e].children.length||(t=i[e].href,n=function(){P&&(F(this,P),y||X(window,"resize",y=L(function(){o.forEach(function(e){F(e.children[0],P)})},100),{passive:!0,capture:!1})),o[e].textContent="",V(o[e],"tt-img"),o[e].appendChild(this)},X(r=document.createElement("img"),"load",function e(){G(r,"load",e),V(r,r.height>r.width?"tt-portrait":r.height===r.width?"tt-square":"tt-landscape"),n.call(r)}),r.src=t)},m=function(e){if(e<0||e>=i.length)return!1;setTimeout(function(){g(e)},1e3)},w=function(){f&&G(l,f.isTouch?"touchmove":"mousemove",f,{passive:!1,capture:!1}),d&&(d.isTouch?(G(l,"touchend",d,{passive:!0,capture:!1}),G(l,"touchcancel",d,{passive:!0,capture:!1})):G(l,"mouseup",d,{passive:!0,capture:!1})),d=f=null},D=function(e){var t;T=e?(t=[b((t=e).style.getPropertyValue("margin-left")||"")[0]||0,b(t.style.getPropertyValue("margin-top")||"")[0]||0],e=b(e.style.getPropertyValue("transform")||""),E=t[0],S=t[1],null!=e[0]?e[0]:1):(S=E=0,1)},C=!!(e=e||{}).auto,P=e.fit,z||(V(z=document.createElement("div"),"tt-gallery-overlay"),"ontouchstart"in window&&V(z,"tt-touch-screen"),A(z)),l=V(document.createElement("div"),"tt-gallery-slider"),e.slider&&V(l,e.slider),l.id="tt-gallery-slider-"+String(++H),l.style.setProperty("touch-action","none"),l.style.setProperty("-moz-transition-duration",String(e.swipe||400)+"ms"),l.style.setProperty("-webkit-transition-duration",String(e.swipe||400)+"ms"),l.style.setProperty("transition-duration",String(e.swipe||400)+"ms"),p=V(document.createElement("a"),"tt-prev-arrow"),e.prevArrow&&V(p,e.prevArrow),h=V(document.createElement("a"),"tt-next-arrow"),e.nextArrow&&V(h,e.nextArrow),e.showCaption&&(t=V(document.createElement("div"),"tt-caption"),e.caption)&&V(t,e.caption),o=i.map(function(e){var t=document.createElement("div");return V(t,"tt-placeholder"),l.appendChild(t),t}),X(l,"touchstart",n=L(function(e){var o,a,u,t,n,s=e.touches&&e.touches.length,r=e.target;"img"===r.tagName.toLowerCase()?s&&2===e.touches.length||!s&&(e.ctrlKey||e.metaKey)?(w(),o=s?e.touches[0].pageX<=e.touches[1].pageX?[e.touches[0],e.touches[1]]:[e.touches[1],e.touches[0]]:null,a=s?[o[0].pageX,o[0].pageY,o[1].pageX,o[1].pageY]:[e.pageX,e.pageY],u=r,X(l,s?"touchmove":"mousemove",f=function(e){var t,n,r,i;return e.preventDefault&&e.preventDefault(),s&&2!==e.touches.length||(t=s?[o[0].identifier===e.touches[0].identifier?e.touches[0]:o[0].identifier===e.touches[1].identifier?e.touches[1]:null,o[1].identifier===e.touches[0].identifier?e.touches[0]:o[1].identifier===e.touches[1].identifier?e.touches[1]:null]:null,(!s||t[0]&&t[1])&&(t=s?[t[0].pageX,t[0].pageY,t[1].pageX,t[1].pageY]:[e.pageX,e.pageY],e=s?(n=E+t[2]-a[2],r=S+t[3]-a[3],i=k.hypot(t[2]-t[0],t[3]-t[1])/k.hypot(a[2]-a[0],a[3]-a[1])-1,K(T+4*i,1,3)):(n=E+t[0]-a[0],r=S+t[1]-a[1],T),k.abs(e-1)<.01?I(u,E=0,S=0,T=1):!s||k.abs(i)<.08?M(u,E=n,S=r):R(u,T=e),a=t)),!1},{passive:!1,capture:!1}),f.isTouch=s,d=L(w,200),s?(X(l,"touchend",d,{passive:!0,capture:!1}),X(l,"touchcancel",d,{passive:!0,capture:!1})):X(l,"mouseup",d,{passive:!0,capture:!1}),d.isTouch=s):s&&1!==e.touches.length||(w(),t=s?e.touches[0]:null,n=(s?t:e).pageX,X(l,s?"touchmove":"mousemove",f=function(e){return e.preventDefault&&e.preventDefault(),s&&(1!==e.touches.length||t.identifier!==e.touches[0].identifier)||(15<(e=(s?e.touches[0]:e).pageX-n)?c.showPrevious():e<-15&&c.showNext()),!1},{passive:!1,capture:!1}),f.isTouch=s,d=L(w,200),s?(X(l,"touchend",d,{passive:!0,capture:!1}),X(l,"touchcancel",d,{passive:!0,capture:!1})):X(l,"mouseup",d,{passive:!0,capture:!1}),d.isTouch=s):p!==r&&h!==r&&c.hideGallery()},60,function(e){return e.preventDefault&&e.preventDefault(),!1}),{passive:!1,capture:!1}),X(l,"mousedown",n,{passive:!1,capture:!1}),X(l,"wheel",r=function(e){var t;"img"===e.target.tagName.toLowerCase()&&(e.ctrlKey||e.metaKey)&&(e.preventDefault&&e.preventDefault(),t=e.target,T=K(T-.001*e.deltaY,1,3),k.abs(T-1)<.01?I(t,E=0,S=0,T=1):R(t,T))},{passive:!1,capture:!1}),X(window,"keydown",a=function(e){var t;j===c&&(t=0<=x&&x<i.length?o[x].children[0]:null,27===e.keyCode?c.hideGallery():38===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<T&&(e.preventDefault&&e.preventDefault(),M(t,E,S-=10)):40===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<T&&(e.preventDefault&&e.preventDefault(),M(t,E,S+=10)):37===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<T&&(e.preventDefault&&e.preventDefault(),M(t,E-=10,S)):39===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<T&&(e.preventDefault&&e.preventDefault(),M(t,E+=10,S)):38===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),T=K(T+.2,1,3),k.abs(T-1)<.01?I(t,E=0,S=0,T=1):R(t,T)):40===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),T=K(T-.2,1,3),k.abs(T-1)<.01?I(t,E=0,S=0,T=1):R(t,T)):37===e.keyCode?(e.preventDefault&&e.preventDefault(),c.showPrevious()):39===e.keyCode&&(e.preventDefault&&e.preventDefault(),c.showNext()))},{passive:!1,capture:!1}),X(p,"click",u=function(e){e.preventDefault&&e.preventDefault(),c.showPrevious()},{passive:!1,capture:!1}),X(h,"click",s=function(e){e.preventDefault&&e.preventDefault(),c.showNext()},{passive:!1,capture:!1}),C||(v=i.map(function(e,t){return X(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),x=t,c.showGallery()},{passive:!1,capture:!1}),e})),c.showGallery=function(){var e;return j!==c&&(z.textContent="",z.appendChild(l),z.appendChild(p),z.appendChild(h),t&&z.appendChild(t),i.length&&D(o[x].children[0]),q(l,x),t&&i.length&&(t.textContent=String(x+1)+"/"+String(i.length)),e=c,O||(O=!0,j=e,document.body.appendChild(("none"===(e=z).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),e)),setTimeout(function(){V(z,"tt-visible")},60)),g(x),m(x+1),m(x-1)),c},c.hideGallery=function(){return j===c&&(w(),W()),c},c.showNext=function(){var e;return j===c&&(w(),x+1<i.length?(e=o[x].children[0],setTimeout(function(){I(e)},40),D(o[++x].children[0]),q(l,x),t&&i.length&&(t.textContent=String(x+1)+"/"+String(i.length)),m(x+1)):(V(l,"tt-right-spring"),setTimeout(function(){Y(l,"tt-right-spring")},500))),c},c.showPrevious=function(){var e;return j===c&&(w(),0<x?(e=o[x].children[0],setTimeout(function(){I(e)},40),D(o[--x].children[0]),q(l,x),t&&i.length&&(t.textContent=String(x+1)+"/"+String(i.length)),m(x-1)):(V(l,"tt-left-spring"),setTimeout(function(){Y(l,"tt-left-spring")},500))),c},c.dispose=function(){l&&(w(),j===c&&W(),y&&G(window,"resize",y,{passive:!0,capture:!1}),G(window,"keydown",a,{passive:!1,capture:!1}),G(l,"touchstart",n,{passive:!1,capture:!1}),G(l,"mousedown",n,{passive:!1,capture:!1}),G(l,"wheel",r,{passive:!1,capture:!1}),G(p,"click",u,{passive:!1,capture:!1}),G(h,"click",s,{passive:!1,capture:!1}),v&&i.forEach(function(e,t){G(e,"click",v[t],{passive:!1,capture:!1})}),v=s=u=r=d=f=n=a=y=null,l.textContent="",e=i=o=t=h=p=l=null,x=-1,c.showGallery=N,c.hideGallery=N,c.showNext=N,c.showPrevious=N)}}$.VERSION="1.5.0",$.prototype={constructor:$,dispose:N,showGallery:N,hideGallery:N,showNext:N,showPrevious:N},window.touchTouch=$}();