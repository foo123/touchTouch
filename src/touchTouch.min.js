/**
*  touchTouch.js
*  Enhanced Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.5.0
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var T=Math,i=null,t=/(?:-?\d+(?:\.\d+)?)|(?:-?\.\d+)/g,n=/^\s+|\s+$/g,r=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(n,"")};function E(){}function o(e){return parseFloat(e||0)||0}function x(e){return(String(e).match(t)||[]).map(o)}function D(e,t,n){return T.min(T.max(e,t),n)}function C(n,r,i){var o;return function(){var e=this,t=arguments;if(clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},r),i)return i.apply(e,t)}}function s(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",E,e),window.removeEventListener("test",E,e)}catch(e){t=!1}return t}function N(e,t,n,r){null==i&&(i=s()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function S(e,t,n,r){null==i&&(i=s()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function k(e,t){return e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t,e}function L(e,t){e.classList?e.classList.remove(t):e.className=r((" "+e.className+" ").replace(" "+t+" "," "))}function b(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var X=null,G=null,V=!1,Y=0;function A(e){X&&(27===e.keyCode?K():37===e.keyCode?X.showPrevious():39===e.keyCode&&X.showNext())}function K(){V&&(V=!1,X=null,S(window,"keydown",A,{passive:!0,capture:!1}),L(b(G),"tt-visible"),setTimeout(function(){G.textContent=""},0))}function j(e,t){e.style.left=String(100*-t)+"%"}function z(e,t){var n,r,i;e&&"img"===(e.tagName||"").toLowerCase()&&(n=e.width,r=e.height,i=t*(window.innerWidth||document.documentElement.clientWidth),(t=t*(window.innerHeight||document.documentElement.clientHeight))<r*i/n?(e.style.height=String(t)+"px",e.style.width="auto"):(e.style.width=String(i)+"px",e.style.height="auto"))}function O(e){e&&(e.style.removeProperty("margin-left"),e.style.removeProperty("margin-top"),e.style.removeProperty("transform-origin"),e.style.removeProperty("transform"))}function H(e,t,n){e&&(e.style.marginLeft=String(t)+"px",e.style.marginTop=String(n)+"px")}function W(e,t){e&&(e.style.transformOrigin="center center",e.style.transform="scale("+String(t)+","+String(t)+")")}function q(e){return x(e.style.getPropertyValue("transform")||"")}function F(i,e){var d=this;if(!(d instanceof F))return new F(i,e);var f,v,m,o,t,y,g,n,r,s,u,a,c,l,w,p,h=0,P=0;i=Array.prototype.slice.call(i||[]),c=function(e){if(e<0||e>=i.length)return!1;var t,n,r;o[e].children.length||(t=i[e].href,n=function(){P&&(z(this,P),a||N(window,"resize",a=C(function(){o.forEach(function(e){z(e.children[0],P)})},100),{passive:!0,capture:!1})),o[e].textContent="",k(o[e],"tt-img"),o[e].appendChild(this)},N(r=document.createElement("img"),"load",function e(){S(r,"load",e),k(r,r.height>r.width?"tt-portrait":r.height===r.width?"tt-square":"tt-landscape"),n.call(r)}),r.src=t)},l=function(e){if(e<0||e>=i.length)return!1;setTimeout(function(){c(e)},1e3)},w=function(){y&&S(f,y.isTouch?"touchmove":"mousemove",y,{passive:!1,capture:!1}),g&&(g.isTouch?(S(f,"touchend",g,{passive:!0,capture:!1}),S(f,"touchcancel",g,{passive:!0,capture:!1})):S(f,"mouseup",g,{passive:!0,capture:!1})),g=y=null},p=!!(e=e||{}).auto,P=e.fit,G||(k(G=document.createElement("div"),"tt-gallery-overlay"),"ontouchstart"in window&&k(G,"tt-touch-screen"),b(G)),f=k(document.createElement("div"),"tt-gallery-slider"),e.slider&&k(f,e.slider),f.id="tt-gallery-slider-"+String(++Y),f.style.setProperty("touch-action","none"),f.style.setProperty("-moz-transition-duration",String(e.swipe||400)+"ms"),f.style.setProperty("-webkit-transition-duration",String(e.swipe||400)+"ms"),f.style.setProperty("transition-duration",String(e.swipe||400)+"ms"),v=k(document.createElement("a"),"tt-prev-arrow"),e.prevArrow&&k(v,e.prevArrow),m=k(document.createElement("a"),"tt-next-arrow"),e.nextArrow&&k(m,e.nextArrow),o=i.map(function(e){var t=document.createElement("div");return k(t,"tt-placeholder"),f.appendChild(t),t}),N(f,"touchstart",t=C(function(e){var o,s,u,t,a,c,l,n,r,i,p=e.touches&&e.touches.length,h=e.target;"img"===h.tagName.toLowerCase()?p&&2===e.touches.length||!p&&(e.ctrlKey||e.metaKey)?(w(),o=p?e.touches[0].pageX<=e.touches[1].pageX?[e.touches[0],e.touches[1]]:[e.touches[1],e.touches[0]]:null,s=p?[o[0].pageX,o[0].pageY,o[1].pageX,o[1].pageY]:[e.pageX,e.pageY],i=[x((i=u=h).style.getPropertyValue("margin-left")||"")[0]||0,x(i.style.getPropertyValue("margin-top")||"")[0]||0],t=q(u),a=i[0],c=i[1],l=null!=t[0]?t[0]:1,N(f,p?"touchmove":"mousemove",y=function(e){var t,n,r,i;return e.preventDefault&&e.preventDefault(),p&&2!==e.touches.length||(t=p?[o[0].identifier===e.touches[0].identifier?e.touches[0]:o[0].identifier===e.touches[1].identifier?e.touches[1]:null,o[1].identifier===e.touches[0].identifier?e.touches[0]:o[1].identifier===e.touches[1].identifier?e.touches[1]:null]:null,(!p||t[0]&&t[1])&&(t=p?[t[0].pageX,t[0].pageY,t[1].pageX,t[1].pageY]:[e.pageX,e.pageY],e=p?(n=a+t[2]-s[2],r=c+t[3]-s[3],i=T.hypot(t[2]-t[0],t[3]-t[1])/T.hypot(s[2]-s[0],s[3]-s[1])-1,D(l+4*i,1,3)):(n=a+t[0]-s[0],r=c+t[1]-s[1],l),T.abs(e-1)<.01?O(u,a=0,c=0,l=1):!p||T.abs(i)<.08?H(u,a=n,c=r):W(u,l=e),s=t)),!1},{passive:!1,capture:!1}),y.isTouch=p,g=C(w,200),p?(N(f,"touchend",g,{passive:!0,capture:!1}),N(f,"touchcancel",g,{passive:!0,capture:!1})):N(f,"mouseup",g,{passive:!0,capture:!1}),g.isTouch=p):p&&1!==e.touches.length||(w(),n=p?e.touches[0]:null,r=(p?n:e).pageX,N(f,p?"touchmove":"mousemove",y=function(e){return e.preventDefault&&e.preventDefault(),p&&(1!==e.touches.length||n.identifier!==e.touches[0].identifier)||(15<(e=(p?e.touches[0]:e).pageX-r)?d.showPrevious():e<-15&&d.showNext()),!1},{passive:!1,capture:!1}),y.isTouch=p,g=C(w,200),p?(N(f,"touchend",g,{passive:!0,capture:!1}),N(f,"touchcancel",g,{passive:!0,capture:!1})):N(f,"mouseup",g,{passive:!0,capture:!1}),g.isTouch=p):v!==h&&m!==h&&d.hideGallery()},60,function(e){return e.preventDefault&&e.preventDefault(),!1}),{passive:!1,capture:!1}),N(f,"mousedown",t,{passive:!1,capture:!1}),N(f,"wheel",n=function(e){var t,n;"img"===e.target.tagName.toLowerCase()&&(e.ctrlKey||e.metaKey)&&(e.preventDefault&&e.preventDefault(),n=D((n=null!=(n=q(t=e.target))[0]?n[0]:1)-.001*e.deltaY,1,3),T.abs(n-1)<.01?O(t,n=1):W(t,n))},{passive:!1,capture:!1}),N(v,"click",r=function(e){e.preventDefault&&e.preventDefault(),d.showPrevious()},{passive:!1,capture:!1}),N(m,"click",s=function(e){e.preventDefault&&e.preventDefault(),d.showNext()},{passive:!1,capture:!1}),p||(u=i.map(function(e,t){return N(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),h=t,d.showGallery()},{passive:!1,capture:!1}),e})),d.showGallery=function(){var e;return X!==d&&(G.textContent="",G.appendChild(f),G.appendChild(v),G.appendChild(m),j(f,h),e=d,V||(V=!0,X=e,document.body.appendChild(("none"===(e=G).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),e)),N(window,"keydown",A,{passive:!0,capture:!1}),setTimeout(function(){k(G,"tt-visible")},60)),c(h),l(h+1),l(h-1)),d},d.hideGallery=function(){return X===d&&(w(),K()),d},d.showNext=function(){var e;return X===d&&(w(),h+1<i.length?(e=o[h].children[0],setTimeout(function(){O(e)},40),j(f,++h),l(h+1)):(k(f,"tt-right-spring"),setTimeout(function(){L(f,"tt-right-spring")},500))),d},d.showPrevious=function(){var e;return X===d&&(w(),0<h?(e=o[h].children[0],setTimeout(function(){O(e)},40),j(f,--h),l(h-1)):(k(f,"tt-left-spring"),setTimeout(function(){L(f,"tt-left-spring")},500))),d},d.dispose=function(){f&&(w(),X===d&&K(),a&&S(window,"resize",a,{passive:!0,capture:!1}),S(f,"touchstart",t,{passive:!1,capture:!1}),S(f,"mousedown",t,{passive:!1,capture:!1}),S(f,"wheel",n,{passive:!1,capture:!1}),S(v,"click",r,{passive:!1,capture:!1}),S(m,"click",s,{passive:!1,capture:!1}),u&&i.forEach(function(e,t){S(e,"click",u[t],{passive:!1,capture:!1})}),u=s=r=n=g=t=y=a=null,f.textContent="",e=i=o=m=v=f=null,d.showGallery=E,d.hideGallery=E,d.showNext=E,d.showPrevious=E)}}F.VERSION="1.5.0",F.prototype={constructor:F,dispose:E,showGallery:E,hideGallery:E,showNext:E,showPrevious:E},window.touchTouch=F}();