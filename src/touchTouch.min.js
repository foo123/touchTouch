/**
*  touchTouch.js
*  Enhanced Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.5.1
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var X=Math,i=null,t=/(?:-?\d+(?:\.\d+)?)|(?:-?\.\d+)/g,n=/^\s+|\s+$/g,r=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(n,"")};function G(){}function o(e){return parseFloat(e||0)||0}function V(e){return(String(e).match(t)||[]).map(o)}function Y(e,t,n){return X.min(X.max(e,t),n)}function _(n,r,i){var o;return function(){var e=this,t=arguments;if(clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},r),i)return i.apply(e,t)}}function a(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",G,e),window.removeEventListener("test",G,e)}catch(e){t=!1}return t}function z(e,t,n,r){null==i&&(i=a()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function A(e,t,n,r){null==i&&(i=a()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?r:"object"==typeof r?!!r.capture:!!r)}function j(e,t){return e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t,e}function O(e,t){e.classList?e.classList.remove(t):e.className=r((" "+e.className+" ").replace(" "+t+" "," "))}function H(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var W=null,q=null,F=!1,I=0;function M(){F&&(F=!1,W=null,O(H(q),"tt-visible"),setTimeout(function(){q.textContent=""},0))}function R(e,t){e.style.left=String(100*-t)+"%"}function $(e,t,n){var r,i,o;e&&"img"===(e.tagName||"").toLowerCase()&&(o=e.width,r=e.height,i=window.innerWidth||document.documentElement.clientWidth,o*(o=window.innerHeight||document.documentElement.clientHeight)<r*i?(e.style.height=String(t*X.min(n,o))+"px",e.style.width="auto"):(e.style.width=String(t*X.min(n,i))+"px",e.style.height="auto"))}function B(e){e&&(e.style.removeProperty("margin-left"),e.style.removeProperty("margin-top"),e.style.removeProperty("transform-origin"),e.style.removeProperty("transform"))}function J(e,t,n){e&&(e.style.marginLeft=String(t)+"px",e.style.marginTop=String(n)+"px")}function Q(e,t){e&&(e.style.transformOrigin="center center",e.style.transform="scale("+String(t)+","+String(t)+")")}function U(i,e){var l=this;if(!(l instanceof U))return new U(i,e);var c,p,h,t,o,n,f,d,r,a,u,s,v,y,m,g,w,D,C,P=0,x=1/0,k=4,E=.08,S=15,T=15,N=0,b=0,K=0,L=1;i=Array.prototype.slice.call(i||[]),m=function(e){if(e<0||e>=i.length)return!1;var t,n,r;o[e].children.length||(t=i[e].href,n=function(){P&&($(this,P,x),y||z(window,"resize",y=_(function(){o.forEach(function(e){$(e.children[0],P,x)})},100),{passive:!0,capture:!1})),o[e].textContent="",j(o[e],"tt-img"),o[e].appendChild(this)},z(r=document.createElement("img"),"load",function e(){A(r,"load",e),j(r,r.height>r.width?"tt-portrait":r.height===r.width?"tt-square":"tt-landscape"),n.call(r)}),r.src=t)},g=function(e){if(e<0||e>=i.length)return!1;setTimeout(function(){m(e)},200)},w=function(){f&&A(c,f.isTouch?"touchmove":"mousemove",f,{passive:!1,capture:!1}),d&&(d.isTouch?(A(c,"touchend",d,{passive:!0,capture:!1}),A(c,"touchcancel",d,{passive:!0,capture:!1})):A(c,"mouseup",d,{passive:!0,capture:!1})),d=f=null},D=function(e){var t;L=e?(t=[V((t=e).style.getPropertyValue("margin-left")||"")[0]||0,V(t.style.getPropertyValue("margin-top")||"")[0]||0],e=V(e.style.getPropertyValue("transform")||""),b=t[0],K=t[1],null!=e[0]?e[0]:1):(K=b=0,1)},C=!!(e=e||{}).auto,P=e.fit,x=null!=e.fitsize?+e.fitsize:1/0,null!=e._factor&&(k=+e._factor),null!=e._threshold&&(E=+e._threshold),null!=e._move&&(S=T=+e._move),q||(j(q=document.createElement("div"),"tt-gallery-overlay"),"ontouchstart"in window&&j(q,"tt-touch-screen"),H(q)),c=j(document.createElement("div"),"tt-gallery-slider"),e.slider&&j(c,e.slider),c.id="tt-gallery-slider-"+String(++I),c.style.setProperty("touch-action","none"),c.style.setProperty("-moz-transition-duration",String(e.swipe||400)+"ms"),c.style.setProperty("-webkit-transition-duration",String(e.swipe||400)+"ms"),c.style.setProperty("transition-duration",String(e.swipe||400)+"ms"),p=j(document.createElement("a"),"tt-prev-arrow"),e.prevArrow&&j(p,e.prevArrow),h=j(document.createElement("a"),"tt-next-arrow"),e.nextArrow&&j(h,e.nextArrow),e.showCaption&&(t=j(document.createElement("div"),"tt-caption"),e.caption)&&j(t,e.caption),o=i.map(function(e){var t=document.createElement("div");return j(t,"tt-placeholder"),c.appendChild(t),t}),z(c,"touchstart",n=_(function(e){var o,a,u,n,r,s=e.touches&&e.touches.length,t=e.target;"img"===t.tagName.toLowerCase()?s&&2===e.touches.length||!s&&(e.ctrlKey||e.metaKey)?(w(),o=s?e.touches[0].pageX<=e.touches[1].pageX?[e.touches[0],e.touches[1]]:[e.touches[1],e.touches[0]]:null,a=s?[o[0].pageX,o[0].pageY,o[1].pageX,o[1].pageY]:[e.pageX,e.pageY],u=t,z(c,s?"touchmove":"mousemove",f=function(e){var t,n,r,i;return e.preventDefault&&e.preventDefault(),s&&2!==e.touches.length||(t=s?[o[0].identifier===e.touches[0].identifier?e.touches[0]:o[0].identifier===e.touches[1].identifier?e.touches[1]:null,o[1].identifier===e.touches[0].identifier?e.touches[0]:o[1].identifier===e.touches[1].identifier?e.touches[1]:null]:null,(!s||t[0]&&t[1])&&(t=s?[t[0].pageX,t[0].pageY,t[1].pageX,t[1].pageY]:[e.pageX,e.pageY],e=s?(n=b+t[2]-a[2],r=K+t[3]-a[3],i=X.hypot(t[2]-t[0],t[3]-t[1])/X.hypot(a[2]-a[0],a[3]-a[1])-1,Y(L+i*k,1,3)):(n=b+t[0]-a[0],r=K+t[1]-a[1],L),X.abs(e-1)<.01?B(u,b=0,K=0,L=1):!s||X.abs(i)<E?J(u,b=n,K=r):Q(u,L=e),a=t)),!1},{passive:!1,capture:!1}),f.isTouch=s,d=_(w,200),s?(z(c,"touchend",d,{passive:!0,capture:!1}),z(c,"touchcancel",d,{passive:!0,capture:!1})):z(c,"mouseup",d,{passive:!0,capture:!1}),d.isTouch=s):s&&1!==e.touches.length||(w(),n=s?e.touches[0]:null,r=(s?n:e).pageX,z(c,s?"touchmove":"mousemove",f=function(e){var t;return e.preventDefault&&e.preventDefault(),s&&(1!==e.touches.length||n.identifier!==e.touches[0].identifier)||(e=(s?e.touches[0]:e).pageX-r,(t=s?S:T)<e?l.showPrevious():e<-t&&l.showNext()),!1},{passive:!1,capture:!1}),f.isTouch=s,d=_(w,200),s?(z(c,"touchend",d,{passive:!0,capture:!1}),z(c,"touchcancel",d,{passive:!0,capture:!1})):z(c,"mouseup",d,{passive:!0,capture:!1}),d.isTouch=s):p!==t&&h!==t&&l.hideGallery()},60,function(e){return e.preventDefault&&e.preventDefault(),!1}),{passive:!1,capture:!1}),z(c,"mousedown",n,{passive:!1,capture:!1}),z(c,"wheel",r=function(e){var t;"img"===e.target.tagName.toLowerCase()&&(e.ctrlKey||e.metaKey)&&(e.preventDefault&&e.preventDefault(),t=e.target,L=Y(L-.001*e.deltaY,1,3),X.abs(L-1)<.01?B(t,b=0,K=0,L=1):Q(t,L))},{passive:!1,capture:!1}),z(p,"click",u=function(e){e.preventDefault&&e.preventDefault(),l.showPrevious()},{passive:!(a=function(e){var t;W===l&&(t=0<=N&&N<i.length?o[N].children[0]:null,27===e.keyCode?l.hideGallery():38===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<L&&(e.preventDefault&&e.preventDefault(),J(t,b,K-=10)):40===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<L&&(e.preventDefault&&e.preventDefault(),J(t,b,K+=10)):37===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<L&&(e.preventDefault&&e.preventDefault(),J(t,b-=10,K)):39===e.keyCode&&(e.ctrlKey||e.metaKey)?t&&1<L&&(e.preventDefault&&e.preventDefault(),J(t,b+=10,K)):38===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),L=Y(L+.2,1,3),X.abs(L-1)<.01?B(t,b=0,K=0,L=1):Q(t,L)):40===e.keyCode?t&&(e.preventDefault&&e.preventDefault(),L=Y(L-.2,1,3),X.abs(L-1)<.01?B(t,b=0,K=0,L=1):Q(t,L)):37===e.keyCode?(e.preventDefault&&e.preventDefault(),l.showPrevious()):39===e.keyCode&&(e.preventDefault&&e.preventDefault(),l.showNext()))}),capture:!1}),z(h,"click",s=function(e){e.preventDefault&&e.preventDefault(),l.showNext()},{passive:!1,capture:!1}),C||(v=i.map(function(e,t){return z(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),N=t,l.showGallery()},{passive:!1,capture:!1}),e})),l.showGallery=function(){var e;return W!==l&&(q.textContent="",q.appendChild(c),q.appendChild(p),q.appendChild(h),t&&q.appendChild(t),i.length&&D(o[N].children[0]),R(c,N),t&&i.length&&(t.textContent=String(N+1)+"/"+String(i.length)),e=l,F||(F=!0,W=e,document.body.appendChild(("none"===(e=q).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),e)),setTimeout(function(){j(q,"tt-visible")},60)),z(window,"keydown",a,{passive:!1,capture:!1}),m(N),g(N+1),g(N-1)),l},l.hideGallery=function(){return W===l&&(w(),A(window,"keydown",a,{passive:!1,capture:!1}),M()),l},l.showNext=function(){var e;return W===l&&(w(),N+1<i.length?(e=o[N].children[0],setTimeout(function(){B(e)},40),D(o[++N].children[0]),R(c,N),t&&i.length&&(t.textContent=String(N+1)+"/"+String(i.length)),g(N+1)):(j(c,"tt-right-spring"),setTimeout(function(){O(c,"tt-right-spring")},500))),l},l.showPrevious=function(){var e;return W===l&&(w(),0<N?(e=o[N].children[0],setTimeout(function(){B(e)},40),D(o[--N].children[0]),R(c,N),t&&i.length&&(t.textContent=String(N+1)+"/"+String(i.length)),g(N-1)):(j(c,"tt-left-spring"),setTimeout(function(){O(c,"tt-left-spring")},500))),l},l.dispose=function(){c&&(w(),y&&A(window,"resize",y,{passive:!0,capture:!1}),A(window,"keydown",a,{passive:!1,capture:!1}),A(c,"touchstart",n,{passive:!1,capture:!1}),A(c,"mousedown",n,{passive:!1,capture:!1}),A(c,"wheel",r,{passive:!1,capture:!1}),A(p,"click",u,{passive:!1,capture:!1}),A(h,"click",s,{passive:!1,capture:!1}),v&&i.forEach(function(e,t){A(e,"click",v[t],{passive:!1,capture:!1})}),W===l&&M(),v=s=u=r=d=f=n=a=y=null,c.textContent="",e=i=o=t=h=p=c=null,N=-1,l.showGallery=G,l.hideGallery=G,l.showNext=G,l.showPrevious=G)}}U.VERSION="1.5.1",U.prototype={constructor:U,dispose:G,showGallery:G,hideGallery:G,showNext:G,showPrevious:G},window.touchTouch=U}();