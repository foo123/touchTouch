/**
*  touchTouch.js
*  Vanilla JavaScript version of https://github.com/tutorialzine/touchTouch Optimized Mobile Gallery by Martin Angelov
*  @VERSION: 1.3.0
*  @license: MIT License
*
*  https://github.com/foo123/touchTouch
*
**/
!function(){"use strict";var o=null,t=/^\s+|\s+$/g,n=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(t,"")};function r(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function m(e,t,n,i){null==o&&(o=r()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,o?i:"object"==typeof i?!!i.capture:!!i)}function E(e,t,n,i){null==o&&(o=r()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,o?i:"object"==typeof i?!!i.capture:!!i)}function C(e,t){e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t}function N(e,t){e.classList?e.classList.remove(t):e.className=n((" "+e.className+" ").replace(" "+t+" "," "))}function x(e){return e.style.setProperty("--touchTouchDisplay",e.style.getPropertyValue("display")),e.style.display="none",e}var k=null,D=null,L=!1,P=0;function S(){L&&(L=!1,k=null,N(x(D),"visible"),setTimeout(function(){D.textContent=""},0))}function T(e,t){var n,i,o;e&&"img"===(e.tagName||"").toLowerCase()&&(n=e.width,i=e.height,o=t*window.innerWidth,(t=t*window.innerHeight)<i*o/n?(e.style.height=String(t)+"px",e.style.width="auto"):(e.style.width=String(o)+"px",e.style.height="auto"))}function b(o,r){var s=this;if(!(s instanceof b))return new b(o,r);var a,t,n,c,i,e,u,l,p,h,d,v=0,f=null,w=(r=r||{},D||((D=document.createElement("div")).id="galleryOverlay","ontouchstart"in window&&C(D,"is-touch-screen"),document.body.appendChild(x(D)),m(window,"keydown",function(e){k&&(27===e.keyCode?S():37===e.keyCode?k.showPrevious():39===e.keyCode&&k.showNext())},{passive:!0,capture:!1})),a=document.createElement("div"),t=document.createElement("a"),n=document.createElement("a"),a.id="gallerySlider"+String(++P),C(a,"gallery-slider"),r.slider&&C(a,r.slider),C(t,"prev-arrow"),r.prevArrow&&C(t,r.prevArrow),C(n,"next-arrow"),r.nextArrow&&C(n,r.nextArrow),o=Array.prototype.slice.call(o||[]),c=o.map(function(e,t){var n=document.createElement("div");return C(n,"placeholder"),a.appendChild(n),n}),m(a,"click",e=function(e){"img"!==e.target.tagName.toLowerCase()&&S()},{passive:!0,capture:!1}),m(t,"click",u=function(e){e.preventDefault&&e.preventDefault(),s.showPrevious()},{passive:!1,capture:!1}),m(n,"click",l=function(e){e.preventDefault&&e.preventDefault(),s.showNext()},{passive:!1,capture:!1}),m(a,"touchstart",p=function(e){var n,i;return"img"===e.target.tagName.toLowerCase()&&function(e,t){if(e.closest)return e.closest("#"+t);for(;e;){if(t===e.id)return e;e=e.parentNode}}(e.target,a.id)&&1===e.touches.length&&(n=e.touches[0],i=n.pageX,m(a,"touchmove",f=function e(t){t.preventDefault&&t.preventDefault(),10<(n=t.touches[0]).pageX-i?(E(a,"touchmove",e,{passive:!1,capture:!1}),s.showPrevious()):n.pageX-i<-10&&(E(a,"touchmove",e,{passive:!1,capture:!1}),s.showNext())},{passive:!1,capture:!1})),!1},{passive:!0,capture:!1}),m(a,"touchend",h=function(){f&&E(a,"touchmove",f,{passive:!1,capture:!1}),f=null},{passive:!0,capture:!1}),i=o.map(function(e,t){return m(e,"click",e=function(e){e.preventDefault&&e.preventDefault(),v=t,s.showGallery()},{passive:!1,capture:!1}),e}),s.showGallery=function(){var e;k!==s&&(D.textContent="",D.appendChild(a),D.appendChild(t),D.appendChild(n),w(v),e=s,L||(L=!0,k=e,"none"===(e=D).style.display&&(e.style.display=""!==e.style.getPropertyValue("--touchTouchDisplay")?e.style.getPropertyValue("--touchTouchDisplay"):"block"),setTimeout(function(){C(D,"visible")},0)),g(v),y(v+1),y(v-1))},function(e){a.style.left=String(100*-e)+"%"}),y=function(e){if(e<0||e>=o.length)return!1;setTimeout(function(){g(e)},1e3)},g=function(e){if(e<0||e>=o.length)return!1;var t,n,i;c[e].children.length||(t=o[e].href,n=function(){r.fit&&(T(this,r.fit),d||m(window,"resize",d=function(e){c.forEach(function(e){T(e.children[0],r.fit)})},{passive:!0,capture:!1})),c[e].textContent="",c[e].appendChild(this)},m(i=document.createElement("img"),"load",function e(){E(i,"load",e),C(i,i.height>i.width?"is-portrait":i.height===i.width?"is-square":"is-landscape"),n.call(i)}),i.src=t)};s.showNext=function(){k===s&&(v+1<o.length?(w(++v),y(v+1)):(C(a,"rightSpring"),setTimeout(function(){N(a,"rightSpring")},500)))},s.showPrevious=function(){k===s&&(0<v?(w(--v),y(v-1)):(C(a,"leftSpring"),setTimeout(function(){N(a,"leftSpring")},500)))},s.dispose=function(){a&&(k===s&&S(),d&&E(window,"resize",d,{passive:!0,capture:!1}),f&&E(a,"touchmove",f,{passive:!1,capture:!1}),E(a,"touchstart",p,{passive:!0,capture:!1}),E(a,"touchend",h,{passive:!0,capture:!1}),E(a,"click",e,{passive:!0,capture:!1}),E(t,"click",u,{passive:!1,capture:!1}),E(n,"click",l,{passive:!1,capture:!1}),o.forEach(function(e,t){E(e,"click",i[t],{passive:!1,capture:!1})}),a.textContent="",r=l=u=e=h=p=f=i=o=c=n=t=a=null,s.showGallery=null,s.showNext=null,s.showPrevious=null)}}b.VERSION="1.3.0",b.prototype={constructor:b,dispose:null,showGallery:null,showNext:null,showPrevious:null},window.touchTouch=b}();